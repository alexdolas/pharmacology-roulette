<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Pharmacology Roulette</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Tailwind —á–µ—Ä–µ–∑ CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gradient-to-b from-purple-900 via-indigo-900 to-black min-h-screen flex items-center justify-center">
    <div id="root"></div>

    <!-- React + ReactDOM (UMD) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä –ø–æ–Ω–∏–º–∞–ª JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
  const { useState } = React;

  const PharmacologyRoulette = () => {
    const drugPairs = [
      { drug: 'Opioids', antidote: 'Naloxone', distractors: ['Flumazenil', 'Atropine', 'Glucagon'] },
      { drug: 'Acetaminophen', antidote: 'N-Acetylcysteine', distractors: ['Fomepizole', 'Methylene Blue', 'EDTA'] },
      { drug: 'Warfarin', antidote: 'Vitamin K', distractors: ['Protamine Sulfate', 'Vitamin B12', 'Calcium'] },
      { drug: 'Benzodiazepines', antidote: 'Flumazenil', distractors: ['Naloxone', 'Glucagon', 'Atropine'] },
      { drug: 'Carbon Monoxide', antidote: '100% Oxygen', distractors: ['Hydroxocobalamin', 'Methylene Blue', 'Naloxone'] },
      { drug: 'Beta Blockers', antidote: 'Glucagon', distractors: ['Calcium Chloride', 'Atropine', 'Epinephrine'] },
      { drug: 'Cyanide', antidote: 'Hydroxocobalamin', distractors: ['100% Oxygen', 'Methylene Blue', 'N-Acetylcysteine'] },
      { drug: 'Anticholinergics', antidote: 'Physostigmine', distractors: ['Atropine', 'Pralidoxime', 'Edrophonium'] },
      { drug: 'Digoxin', antidote: 'Digoxin Immune Fab', distractors: ['Calcium Chloride', 'Magnesium Sulfate', 'Potassium'] },
      { drug: 'Heparin', antidote: 'Protamine Sulfate', distractors: ['Vitamin K', 'Tranexamic Acid', 'FFP'] },
      { drug: 'Methanol', antidote: 'Fomepizole', distractors: ['N-Acetylcysteine', 'Ethanol', 'Naloxone'] },
      { drug: 'Ethylene Glycol', antidote: 'Fomepizole', distractors: ['Methylene Blue', 'Naloxone', 'Atropine'] },
      { drug: 'Iron', antidote: 'Deferoxamine', distractors: ['Penicillamine', 'EDTA', 'Dimercaprol'] },
      { drug: 'Lead', antidote: 'EDTA', distractors: ['Deferoxamine', 'Penicillamine', 'Naloxone'] },
      { drug: 'Cholinergics', antidote: 'Atropine', distractors: ['Physostigmine', 'Pralidoxime', 'Neostigmine'] },
      { drug: 'TCAs', antidote: 'Sodium Bicarbonate', distractors: ['Flumazenil', 'Naloxone', 'Atropine'] },
      { drug: 'Magnesium', antidote: 'Calcium Gluconate', distractors: ['Sodium Bicarb', 'Insulin', 'Kayexalate'] },
      { drug: 'Methemoglobin', antidote: 'Methylene Blue', distractors: ['N-Acetylcysteine', 'Fomepizole', 'Naloxone'] },
      { drug: 'Dabigatran', antidote: 'Idarucizumab', distractors: ['Andexanet Alfa', 'Vitamin K', 'Protamine'] },
      { drug: 'Rivaroxaban', antidote: 'Andexanet Alfa', distractors: ['Idarucizumab', 'Vitamin K', 'Protamine'] }
    ];

    const colors = [
      '#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8',
      '#F7DC6F', '#BB8FCE', '#85C1E2', '#F8B739', '#52B788',
      '#E74C3C', '#3498DB', '#F39C12', '#9B59B6', '#1ABC9C',
      '#E67E22', '#2ECC71', '#34495E', '#FF69B4', '#20B2AA'
    ];

    const [spinning, setSpinning] = useState(false);
    const [rotation, setRotation] = useState(0);
    const [currentDrug, setCurrentDrug] = useState(null);
    const [showModal, setShowModal] = useState(false);
    const [completedDrugs, setCompletedDrugs] = useState([]);
    const [score, setScore] = useState({ correct: 0, wrong: 0 });
    const [selectedAnswer, setSelectedAnswer] = useState(null);
    const [showResult, setShowResult] = useState(false);
    const [showConfetti, setShowConfetti] = useState(false);
    const [showVictory, setShowVictory] = useState(false);
    const [shuffledOptions, setShuffledOptions] = useState([]);

    const shuffleArray = (array) => {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    };

    const spinWheel = () => {
      if (spinning || completedDrugs.length === drugPairs.length) return;
      setSpinning(true);
      const availableDrugs = drugPairs.filter((_, index) => !completedDrugs.includes(index));
      const randomIndex = Math.floor(Math.random() * availableDrugs.length);
      const selectedDrug = availableDrugs[randomIndex];
      const drugIndex = drugPairs.indexOf(selectedDrug);
      const segmentAngle = 360 / drugPairs.length;
      const targetAngle = drugIndex * segmentAngle;
      const spins = 5;
      const finalRotation = rotation + (360 * spins) + (360 - targetAngle) + (segmentAngle / 2);
      setRotation(finalRotation);

      setTimeout(() => {
        setSpinning(false);
        setCurrentDrug({ ...selectedDrug, index: drugIndex });
        setShuffledOptions(shuffleArray([selectedDrug.antidote, ...selectedDrug.distractors]));
        setShowModal(true);
        setSelectedAnswer(null);
        setShowResult(false);
      }, 4000);
    };

    const handleAnswer = (answer) => {
      if (showResult) return;
      setSelectedAnswer(answer);
      setShowResult(true);
      const isCorrect = answer === currentDrug.antidote;

      if (isCorrect) {
        setScore(prev => ({ ...prev, correct: prev.correct + 1 }));
        setShowConfetti(true);
        setTimeout(() => setShowConfetti(false), 3000);
      } else {
        setScore(prev => ({ ...prev, wrong: prev.wrong + 1 }));
      }

      setTimeout(() => {
        setCompletedDrugs(prev => [...prev, currentDrug.index]);
        setShowModal(false);
        if (completedDrugs.length + 1 === drugPairs.length) {
          setTimeout(() => setShowVictory(true), 500);
        }
      }, 2000);
    };

    const resetGame = () => {
      setCompletedDrugs([]);
      setScore({ correct: 0, wrong: 0 });
      setShowVictory(false);
      setRotation(0);
    };

    const totalAttempts = score.correct + score.wrong;
    const percentage = totalAttempts > 0 ? Math.round((score.correct / totalAttempts) * 100) : 0;

    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex flex-col items-center justify-center p-4 relative overflow-hidden">
        {showConfetti && (
          <div className="fixed inset-0 pointer-events-none z-50">
            {[...Array(50)].map((_, i) => (
              <div
                key={i}
                className="absolute animate-confetti"
                style={{
                  left: `${Math.random() * 100}%`,
                  top: '-10px',
                  width: '10px',
                  height: '10px',
                  backgroundColor: colors[Math.floor(Math.random() * colors.length)],
                  animationDelay: `${Math.random() * 0.5}s`,
                  animationDuration: `${2 + Math.random() * 2}s`
                }}
              />
            ))}
          </div>
        )}

        <div className="text-center mb-6 relative z-10">
          <h1 className="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-amber-500 mb-2">
            üíä Pharmacology Roulette
          </h1>
          <p className="text-gray-300 text-sm">
            Master Drug-Antidote Pairs ‚Ä¢ {drugPairs.length} Drugs
          </p>
        </div>

        <div className="flex gap-3 mb-4 flex-wrap justify-center">
          <div className="bg-gradient-to-br from-green-600 to-green-700 px-4 py-2 rounded-lg shadow-lg">
            <div className="text-white text-xs font-medium">Correct</div>
            <div className="text-white text-xl font-bold">{score.correct}</div>
          </div>
          <div className="bg-gradient-to-br from-red-600 to-red-700 px-4 py-2 rounded-lg shadow-lg">
            <div className="text-white text-xs font-medium">Wrong</div>
            <div className="text-white text-xl font-bold">{score.wrong}</div>
          </div>
          <div className="bg-gradient-to-br from-yellow-500 to-amber-600 px-4 py-2 rounded-lg shadow-lg">
            <div className="text-white text-xs font-medium">Score</div>
            <div className="text-white text-xl font-bold">{percentage}%</div>
          </div>
        </div>

        <div className="mb-4 text-center">
          <div className="text-gray-300 text-xs mb-2">
            Progress: {completedDrugs.length} / {drugPairs.length}
          </div>
          <div className="w-56 h-2 bg-gray-700 rounded-full overflow-hidden">
            <div
              className="h-full bg-gradient-to-r from-yellow-400 to-amber-500 transition-all duration-500"
              style={{ width: `${(completedDrugs.length / drugPairs.length) * 100}%` }}
            />
          </div>
        </div>

        <div className="relative mb-6">
          <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-2 z-20">
            <div className="w-0 h-0 border-l-[18px] border-l-transparent border-r-[18px] border-r-transparent border-t-[36px] border-t-red-600 drop-shadow-lg" />
          </div>

          <div className="relative w-[320px] h-[320px] md:w-[380px] md:h-[380px]">
            <svg
              className="w-full h-full drop-shadow-2xl"
              style={{
                transform: `rotate(${rotation}deg)`,
                transition: spinning
                  ? 'transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99)'
                  : 'none'
              }}
              viewBox="0 0 400 400"
            >
              <circle cx="200" cy="200" r="198" fill="#000" opacity="0.2" />

              {drugPairs.map((pair, index) => {
                const segmentAngle = 360 / drugPairs.length;
                const angle = segmentAngle * index;
                const nextAngle = segmentAngle * (index + 1);
                const startRad = (angle - 90) * (Math.PI / 180);
                const endRad = (nextAngle - 90) * (Math.PI / 180);
                const midRad = (startRad + endRad) / 2;
                const outerRadius = 195;
                const x1 = 200 + outerRadius * Math.cos(startRad);
                const y1 = 200 + outerRadius * Math.sin(startRad);
                const x2 = 200 + outerRadius * Math.cos(endRad);
                const y2 = 200 + outerRadius * Math.sin(endRad);
                const isCompleted = completedDrugs.includes(index);
                const textRadius = 130;
                const textX = 200 + textRadius * Math.cos(midRad);
                const textY = 200 + textRadius * Math.sin(midRad);
                let rotationText = (midRad * 180) / Math.PI;
                if (rotationText > 90 && rotationText < 270) {
                  rotationText += 180;
                }

                return (
                  <g key={index}>
                    <path
                      d={`M 200 200 L ${x1} ${y1} A ${outerRadius} ${outerRadius} 0 0 1 ${x2} ${y2} Z`}
                      fill={isCompleted ? '#374151' : colors[index]}
                      stroke="#fff"
                      strokeWidth="2"
                      opacity={isCompleted ? 0.3 : 1}
                    />
                    <text
                      x={textX}
                      y={textY}
                      fill="white"
                      fontSize="13"
                      fontWeight="bold"
                      textAnchor="middle"
                      dominantBaseline="middle"
                      opacity={isCompleted ? 0.4 : 1}
                      transform={`rotate(${rotationText} ${textX} ${textY})`}
                    >
                      {pair.drug}
                    </text>
                  </g>
                );
              })}

              <circle
                cx="200"
                cy="200"
                r="35"
                fill="url(#centerGradient)"
                stroke="#ffd700"
                strokeWidth="3"
              />
              <linearGradient id="centerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stopColor="#ffd700" />
                <stop offset="100%" stopColor="#ffed4e" />
              </linearGradient>
            </svg>
          </div>
        </div>

        <button
          onClick={spinWheel}
          disabled={spinning || completedDrugs.length === drugPairs.length}
          className={`px-8 py-3 rounded-full font-bold text-lg shadow-2xl transform transition-all duration-200 ${
            spinning || completedDrugs.length === drugPairs.length
              ? 'bg-gray-600 text-gray-400 cursor-not-allowed'
              : 'bg-gradient-to-r from-yellow-400 to-amber-500 text-gray-900 hover:scale-105 hover:shadow-yellow-500/50 active:scale-95'
          }`}
        >
          {spinning
            ? 'üéØ Spinning...'
            : completedDrugs.length === drugPairs.length
            ? '‚úÖ Complete!'
            : 'üé∞ SPIN WHEEL'}
        </button>

        {showModal && currentDrug && (
          <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-30 animate-fadeIn">
            <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 md:p-8 max-w-md w-full shadow-2xl border-2 border-yellow-500/30 animate-scaleIn">
              <div className="text-center mb-6">
                <div className="inline-block bg-gradient-to-r from-yellow-400 to-amber-500 text-gray-900 px-6 py-2 rounded-full font-bold text-sm mb-4">
                  Question {completedDrugs.length + 1} / {drugPairs.length}
                </div>
                <h2 className="text-2xl md:text-3xl font-bold text-white mb-2">
                  {currentDrug.drug}
                </h2>
                <p className="text-gray-300 text-sm md:text-base">
                  Select the correct antidote:
                </p>
              </div>

              <div className="space-y-3">
                {shuffledOptions.map((option, index) => {
                  const isSelected = selectedAnswer === option;
                  const isCorrect = option === currentDrug.antidote;
                  const showCorrect = showResult && isCorrect;
                  const showWrong = showResult && isSelected && !isCorrect;

                  return (
                    <button
                      key={index}
                      onClick={() => handleAnswer(option)}
                      disabled={showResult}
                      className={`w-full p-4 rounded-xl font-semibold text-left transition-all duration-300 transform ${
                        showCorrect
                          ? 'bg-gradient-to-r from-green-600 to-green-700 text-white scale-105 shadow-lg'
                          : showWrong
                          ? 'bg-gradient-to-r from-red-600 to-red-700 text-white'
                          : isSelected
                          ? 'bg-yellow-500 text-gray-900'
                          : 'bg-slate-700 text-white hover:bg-slate-600 hover:scale-102'
                      } ${showResult ? 'cursor-default' : 'cursor-pointer'}`}
                    >
                      <div className="flex items-center justify-between">
                        <span>{option}</span>
                        {showCorrect && <span className="text-2xl">‚úì</span>}
                        {showWrong && <span className="text-2xl">‚úó</span>}
                      </div>
                    </button>
                  );
                })}
              </div>

              {showResult && (
                <div
                  className={`mt-6 p-4 rounded-xl text-center font-semibold ${
                    selectedAnswer === currentDrug.antidote
                      ? 'bg-green-600/20 text-green-400 border border-green-500/30'
                      : 'bg-red-600/20 text-red-400 border border-red-500/30'
                  }`}
                >
                  {selectedAnswer === currentDrug.antidote
                    ? 'üéâ Correct!'
                    : `‚ùå Wrong! Correct: ${currentDrug.antidote}`}
                </div>
              )}
            </div>
          </div>
        )}

        {showVictory && (
          <div className="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-40 animate-fadeIn">
            <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-8 max-w-md w-full shadow-2xl border-2 border-yellow-500 animate-scaleIn text-center">
              <div className="w-24 h-24 mx-auto mb-4 flex items-center justify-center text-5xl">
                üèÜ
              </div>
              <h2 className="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-amber-500 mb-4">
                üéâ Victory!
              </h2>
              <p className="text-gray-300 text-lg mb-6">
                You've completed all {drugPairs.length} drug-antidote pairs!
              </p>

              <div className="bg-slate-700/50 rounded-xl p-6 mb-6">
                <div className="text-6xl font-bold text-white mb-2">{percentage}%</div>
                <div className="text-gray-300 text-sm">Final Score</div>
                <div className="flex justify-center gap-4 mt-4">
                  <div className="text-green-400">‚úì {score.correct} Correct</div>
                  <div className="text-red-400">‚úó {score.wrong} Wrong</div>
                </div>
              </div>

              <button
                onClick={resetGame}
                className="bg-gradient-to-r from-yellow-400 to-amber-500 text-gray-900 px-8 py-4 rounded-full font-bold text-lg shadow-lg hover:scale-105 transition-transform flex items-center gap-2 mx-auto"
              >
                <span className="text-xl">‚ü≥</span>
                Play Again
              </button>
            </div>
          </div>
        )}

        <style jsx>{`
          @keyframes fadeIn {
            from {
              opacity: 0;
            }
            to {
              opacity: 1;
            }
          }
          @keyframes scaleIn {
            from {
              opacity: 0;
              transform: scale(0.9);
            }
            to {
              opacity: 1;
              transform: scale(1);
            }
          }
          @keyframes confetti {
            0% {
              transform: translateY(0) rotate(0deg);
              opacity: 1;
            }
            100% {
              transform: translateY(100vh) rotate(720deg);
              opacity: 0;
            }
          }
          .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
          }
          .animate-scaleIn {
            animation: scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
          }
          .animate-confetti {
            animation: confetti linear forwards;
          }
        `}</style>
      </div>
    );
  }; 
      
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<PharmacologyRoulette />);
    </script>
  </body>
</html>
